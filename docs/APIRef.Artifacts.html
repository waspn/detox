<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Artifacts · Detox</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="Artifacts are various recordings during tests including, but not limited to, device logs, device screenshots and screen recordings (videos)."/><meta name="docsearch:version" content="8.1.0"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Artifacts · Detox"/><meta property="og:type" content="website"/><meta property="og:url" content="https://wix.github.io/detox/index.html"/><meta property="og:description" content="Artifacts are various recordings during tests including, but not limited to, device logs, device screenshots and screen recordings (videos)."/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/detox/img/favicon.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/detox/css/main.css"/></head><body class="sideNavVisible"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/detox/"><h2 class="headerTitle">Detox</h2></a><a href="/detox/versions.html"><h3>8.1.0</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/detox/docs/Introduction.GettingStarted.html" target="_self">Getting Started</a></li><li class=""><a href="https://github.com/wix/detox" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">Artifacts</h1></header><article><div><span><p>Artifacts are various recordings during tests including, but not limited to, device logs, device screenshots and screen recordings (videos).</p>
<h2><a class="anchor" aria-hidden="true" id="enabling-artifacts"></a><a href="#enabling-artifacts" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Enabling artifacts</h2>
<p>Artifacts are disabled by default. Two things are required to enable them:</p>
<ol>
<li><p><strong>Call <code>detox.beforeEach</code> and <code>detox.afterEach</code> before/after each test</strong>:
In order for artifacts to work, you have to call <code>detox.beforeEach(testSummary)</code> / <code>detox.afterEach(testSummary)</code> before / after each test. Their respective signatures are described in <a href="/detox/docs/APIRef.DetoxObjectAPI.html">detox object</a> documentation. As the interface (typing) of <code>testSummary</code> may change over the time, and in cases with some test runners it is not trivial to implement test title and status extraction (like with Jest), you are encouraged to use Detox adapter functions like in these examples: <a href="/examples/demo-react-native/e2e/init.js">mocha</a>, <a href="/examples/demo-react-native-jest/e2e/init.js">jest</a>.</p></li>
<li><p>Specify via launch arguments which types of artifacts you want to record:</p></li>
</ol>
<ul>
<li>To record <code>.log</code> files, add <code>--record-logs all</code> (or <code>--record-logs failing</code>, if you want to keep logs only for failing tests).</li>
<li>To record <code>.mp4</code> test run videos, add <code>--record-videos all</code> (or <code>--record-videos failing</code>, if you want to keep video recordings only for failing tests).</li>
<li>To record <code>.png</code> screenshots before and after each test, add <code>--take-screenshots all</code> (or <code>--take-screenshots failing</code>, if you want to keep only screenshots of failing tests).</li>
<li>To change artifacts root directory location (by default it is <code>./artifacts</code>), add <code>--artifacts-location &lt;path&gt;</code>.<br>
<strong>NOTE:</strong> There is a slightly obscure convention. If you want to create automatically a subdirectory with timestamp and configuration name (to avoid file overwrites upon consquent re-runs), specify a path to directory that does not end with a slash. Otherwise, if you want to put artifacts straight to the specified directory (in a case where you make a single run only, e.g. on CI), add a slash (or a backslash) to the end.</li>
</ul>
<pre><code class="hljs css languages- sh">detox <span class="hljs-built_in">test</span> --artifacts-location /tmp/detox_artifacts  <span class="hljs-comment"># will also append /android.emu.release.2018-06-14 08:54:11Z</span>
detox <span class="hljs-built_in">test</span> --artifacts-location /tmp/detox_artifacts/ <span class="hljs-comment"># won't append anything, hereby treating it as a root</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="artifacts-structure"></a><a href="#artifacts-structure" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Artifacts structure</h2>
<ol>
<li><p><strong>Artifacts root folder</strong> is created per detox test run. If, for instance,<code>--artifacts-location /tmp</code> is used with <code>--configuration ios.sim.release</code> configuration on 14th June 2018 at 11:02:11 GMT+02, then the folder <code>/tmp/ios.sim.release.2018-06-14 09:02:11Z</code> is created.</p></li>
<li><p><strong>Test folder</strong> is created per test inside the root folder. The folder name consists of the test number, and the test's full name provided to <code>detox.afterEach(testSummary)</code> as explained above and in <a href="/detox/docs/APIRef.DetoxObjectAPI.html">detox object</a> documentation. For instance, for the above example, the following folders will be created inside <code>/tmp/ios.sim.release.2018-06-14 09:02:11Z</code>:</p></li>
</ol>
<pre><code class="hljs">✗ Assertions should assert an element has (accessibility)
✓<span class="hljs-built_in"> Network </span>Synchronization Sync with short<span class="hljs-built_in"> network </span>requests - 100ms
</code></pre>
<ol start="3">
<li><strong>Artifacts files</strong> are created inside the test folders. The files suffixes stand for the files types (currently there are .err.log and .out.log), and the files prefixes are the launch numbers of the application per test (if the app was executed more than once per test, you will have several artifacts of each type - one per launch). For instance, a test folder may contain the following artifacts files:</li>
</ol>
<pre><code class="hljs">test<span class="hljs-selector-class">.log</span>
test<span class="hljs-selector-class">.mp4</span>
beforeEach<span class="hljs-selector-class">.png</span>
afterEach<span class="hljs-selector-class">.png</span>
</code></pre>
<h5><a class="anchor" aria-hidden="true" id="example-of-the-structure"></a><a href="#example-of-the-structure" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example of the structure:</h5>
<pre><code class="hljs">artifacts/android<span class="hljs-selector-class">.emu</span><span class="hljs-selector-class">.release</span>.<span class="hljs-number">2018</span>-<span class="hljs-number">06</span>-<span class="hljs-number">12</span> <span class="hljs-number">06</span>:<span class="hljs-number">36</span>:<span class="hljs-number">18</span>Z/startup<span class="hljs-selector-class">.log</span>
artifacts/android<span class="hljs-selector-class">.emu</span><span class="hljs-selector-class">.release</span>.<span class="hljs-number">2018</span>-<span class="hljs-number">06</span>-<span class="hljs-number">12</span> <span class="hljs-number">06</span>:<span class="hljs-number">36</span>:<span class="hljs-number">18</span>Z/✗ Assertions should assert an element has (accessibility) id/beforeEach<span class="hljs-selector-class">.png</span>
artifacts/android<span class="hljs-selector-class">.emu</span><span class="hljs-selector-class">.release</span>.<span class="hljs-number">2018</span>-<span class="hljs-number">06</span>-<span class="hljs-number">12</span> <span class="hljs-number">06</span>:<span class="hljs-number">36</span>:<span class="hljs-number">18</span>Z/✗ Assertions should assert an element has (accessibility) id/test<span class="hljs-selector-class">.log</span>
artifacts/android<span class="hljs-selector-class">.emu</span><span class="hljs-selector-class">.release</span>.<span class="hljs-number">2018</span>-<span class="hljs-number">06</span>-<span class="hljs-number">12</span> <span class="hljs-number">06</span>:<span class="hljs-number">36</span>:<span class="hljs-number">18</span>Z/✗ Assertions should assert an element has (accessibility) id/test<span class="hljs-selector-class">.mp4</span>
artifacts/android<span class="hljs-selector-class">.emu</span><span class="hljs-selector-class">.release</span>.<span class="hljs-number">2018</span>-<span class="hljs-number">06</span>-<span class="hljs-number">12</span> <span class="hljs-number">06</span>:<span class="hljs-number">36</span>:<span class="hljs-number">18</span>Z/✗ Assertions should assert an element has (accessibility) id/afterEach<span class="hljs-selector-class">.png</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="troubleshooting"></a><a href="#troubleshooting" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Troubleshooting</h2>
<h3><a class="anchor" aria-hidden="true" id="screenshots-and-videos-do-not-appear-in-the-artifacts-folder"></a><a href="#screenshots-and-videos-do-not-appear-in-the-artifacts-folder" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Screenshots and videos do not appear in the artifacts folder</h3>
<p>Make sure you have <code>detox.beforeEach(testSummary)</code> and <code>detox.afterEach(testSummary)</code> calls in your <code>./e2e/init.js</code>. Check out the recommendations on how to do that for <a href="/examples/demo-react-native/e2e/init.js">mocha</a> and <a href="/examples/demo-react-native-jest/e2e/init.js">jest</a> using the out-of-the-box adapters.</p>
<h3><a class="anchor" aria-hidden="true" id="video-recording-issues-on-ci"></a><a href="#video-recording-issues-on-ci" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Video recording issues on CI</h3>
<p>For iOS, you might be getting errors on CI similar to this:</p>
<p><code>Error: Error Domain=NSPOSIXErrorDomain Code=22 &quot;Invalid argument&quot; UserInfo={NSLocalizedDescription=Video recording requires hardware Metal capability.}.</code></p>
<p>Unfortunately, this error is beyond our reach. To fix it, you have to enable hardware acceleration on your build machine, or just disable video recording on CI if it is not possible to turn on the acceleration.</p>
<p>There might be a similar issue on Android when the screenrecording process exits with an error on CI. While the solution might be identical to the one above, also you might try to experiment with other emulator devices and Android OS versions to see if it helps.</p>
<h3><a class="anchor" aria-hidden="true" id="ctrl-c-does-not-terminate-detox-jest-tests-correctly"></a><a href="#ctrl-c-does-not-terminate-detox-jest-tests-correctly" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ctrl+C does not terminate Detox+Jest tests correctly</h3>
<p>This is a known issue. Video or log recording process under Detox+Jest is apt to keep running even after you press Ctrl+C and stop the tests. Furthermore, some of temporary files won't get erased (e.g. <code>/sdcard/83541_0.mp4</code> on Android emulator, or <code>/private/var/folders/lm/thz8hdxs4v3fppjh0fjc2twhfl_3x2/T/f12a4fcb-0d1f-4d98-866c-e7cea4942ade.png</code> on your Mac). It cannot be solved on behalf of Detox itself, because the problem has to do with how Jest runner works with its puppet processes. The issue is on our radar, but the ETA for the fix stays unknown. If you feel able to contribute the fix to <a href="https://github.com/facebook/jest">Jest</a>, you are very welcome.</p>
</span></div></article></div><div class="docs-prevnext"></div></div></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/detox/" class="nav-home"></a><div><h5>Docs</h5><a href="/detox/docs/en/Introduction.GettingStarted.html">Getting Started</a><a href="/detox/docs/en/Guide.Contributing.html">Contributing</a></div><div><h5>Community</h5><a href="/detox/en/users.html">User Showcase</a><a href="http://stackoverflow.com/questions/tagged/detox" target="_blank">Stack Overflow</a></div><div><h5>More</h5><a href="https://github.com/wix/detox">GitHub</a><a class="github-button" href="https://github.com/wix/detox" data-icon="octicon-star" data-count-href="/wix/detox/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><section class="copyright">Copyright © 2018 Wix.com Ltd.</section></footer></div></body></html>